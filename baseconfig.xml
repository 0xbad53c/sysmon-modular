<Sysmon schemaversion="4.22">
   <!-- Capture all hashes -->
   <HashAlgorithms>*</HashAlgorithms>
   <CheckRevocation/>
   <EventFiltering>
      <!-- Event ID 1 == Process Creation. -->
      <RuleGroup name="" groupRelation="or">
        <ProcessCreate onmatch="include">
        </ProcessCreate>
      </RuleGroup>
      <!-- Event ID 2 == File Creation Time. -->
      <RuleGroup name="" groupRelation="or">
        <FileCreateTime onmatch="include">
        </FileCreateTime>
      </RuleGroup>
      <!-- Event ID 3 == Network Connection. -->
      <RuleGroup name="" groupRelation="or">
        <NetworkConnect onmatch="include">
        </NetworkConnect>
      </RuleGroup>
      <!-- Event ID 5 == Process Terminated. -->
      <RuleGroup name="" groupRelation="or">
        <ProcessTerminate onmatch="include">
        </ProcessTerminate>
      </RuleGroup>
      <!-- Event ID 6 == Driver Loaded. -->
      <RuleGroup name="" groupRelation="or">
        <DriverLoad onmatch="include">
        </DriverLoad>
      </RuleGroup>
      <!-- Event ID 7 == Image Loaded. -->
      <RuleGroup name="" groupRelation="or">
        <ImageLoad onmatch="include">
        </ImageLoad>
      </RuleGroup>
      <!-- Event ID 8 == CreateRemoteThread. -->
      <RuleGroup name="" groupRelation="or">
        <CreateRemoteThread onmatch="include">
        </CreateRemoteThread>
      </RuleGroup>
      <!-- Event ID 9 == RawAccessRead. -->
      <RuleGroup name="" groupRelation="or">
        <RawAccessRead onmatch="include">
        </RawAccessRead>
      </RuleGroup>
      <!-- Event ID 10 == ProcessAccess. -->
      <RuleGroup name="" groupRelation="or">
        <ProcessAccess onmatch="include">
        </ProcessAccess>
      </RuleGroup>
      <!-- Event ID 11 == FileCreate. -->
      <RuleGroup name="" groupRelation="or">
        <FileCreate onmatch="include">
        </FileCreate>
      </RuleGroup>
      <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed. -->
      <RuleGroup name="" groupRelation="or">
        <RegistryEvent onmatch="include">
        </RegistryEvent>
      </RuleGroup>
      <!-- Event ID 15 == FileStream Created. -->
      <RuleGroup name="" groupRelation="or">
        <FileCreateStreamHash onmatch="include">
        </FileCreateStreamHash>
      </RuleGroup>
      <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected -->
      <RuleGroup name="" groupRelation="or">
        <PipeEvent onmatch="exclude">
        </PipeEvent>
      </RuleGroup>
      <!-- Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity-->
      <RuleGroup name="" groupRelation="or">
        <WmiEvent onmatch="include">
        </WmiEvent>
      </RuleGroup>
      <!-- Event ID 22 == DNS Events -->
      <RuleGroup name="" groupRelation="or">
        <DnsQuery onmatch="include">
        </DnsQuery>
      </RuleGroup>
</EventFiltering>
</Sysmon>
